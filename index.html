<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendário de Suspensões</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f0f4f8; margin: 0; padding: 0; }
        .header { background-color: #1E3A8A; color: white; padding: 20px; font-size: 26px; font-weight: bold; }
        .calendar-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; padding: 20px; max-width: 1000px; margin: auto; }
        .calendar { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); text-align: center; transition: transform 0.2s; cursor: pointer; }
        .calendar:hover { transform: scale(1.05); }
        .calendar h3 { background-color: #1E3A8A; color: white; padding: 10px; border-radius: 5px; font-size: 18px; margin: 0; }
        .calendar table { width: 100%; margin-top: 10px; border-collapse: collapse; font-size: 14px; }
        .calendar th, .calendar td { padding: 8px; text-align: center; cursor: pointer; }
        .calendar th { color: #1E3A8A; font-weight: bold; }
        .highlight { background-color: #2563EB; color: white; border-radius: 50%; padding: 6px; transition: 0.3s; }
        .highlight:hover { background-color: #1D4ED8; }
        .info-container { margin-top: 20px; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: left; max-width: 800px; margin-left: auto; margin-right: auto; }
        .info-container h2 { color: #1E3A8A; }
    </style>
</head>
<body>
    <div class="header">Calendário de Suspensões - 2025</div>
    <div class="calendar-container" id="calendarContainer">
    </div>
    <div class="info-container" id="infoContainer">
        <h2>Informações da Suspensão</h2>
        <p id="infoDetails">Clique em um mês para ver as suspensões desse período.</p>
    </div>
    <script>
        const sheetID = "1XXfkwIzqUgM8rLeWN5lRqiyhIGRfMI9C"; // Substitua pelo ID real da sua planilha
        const sheetName = "Suspensões de Expediente"; // Nome da aba
        const apiUrl = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
        
        let suspensionsData = {};
        
        function fetchSuspensions() {
            fetch(apiUrl)
                .then(response => response.text())
                .then(data => {
                    const jsonData = JSON.parse(data.substring(47, data.length - 2));
                    jsonData.table.rows.forEach(row => {
                        const month = row.c[1].v; // Coluna do mês
                        const info = `${row.c[0].v} - ${row.c[2].v} a ${row.c[3].v}. Motivo: ${row.c[4].v}. Portaria ${row.c[5].v} (${row.c[6].v}).`;
                        if (!suspensionsData[month]) {
                            suspensionsData[month] = [];
                        }
                        suspensionsData[month].push(info);
                    });
                    generateCalendar();
                })
                .catch(error => console.error("Erro ao buscar dados da planilha:", error));
        }
        
        function generateCalendar() {
            let container = document.getElementById("calendarContainer");
            container.innerHTML = "";
            ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"].forEach((month, index) => {
                let firstDay = new Date(2025, index, 1).getDay();
                let daysInMonth = new Date(2025, index + 1, 0).getDate();
                let calendar = `<div class='calendar' onclick="showSuspensions('${month}')"><h3>${month} 2025</h3><table>`;
                calendar += "<tr><th>D</th><th>S</th><th>T</th><th>Q</th><th>Q</th><th>S</th><th>S</th></tr><tr>";
                for (let i = 0; i < firstDay; i++) calendar += "<td></td>";
                for (let day = 1; day <= daysInMonth; day++) {
                    calendar += `<td>${day}</td>`;
                    if ((day + firstDay) % 7 === 0) calendar += "</tr><tr>";
                }
                calendar += "</tr></table></div>";
                container.innerHTML += calendar;
            });
        }
        
        function showSuspensions(month) {
            let infoDetails = document.getElementById("infoDetails");
            let suspensionInfo = suspensionsData[month] && suspensionsData[month].length > 0 ? suspensionsData[month].join("<br>") : `Nenhuma suspensão registrada para ${month}.`;
            infoDetails.innerHTML = suspensionInfo;
        }
        
        fetchSuspensions();
    </script>
</body>
</html>
