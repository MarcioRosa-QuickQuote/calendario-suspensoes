<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendário de Suspensões de Expedientes</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; background-color: #f0f4f8; margin: 0; padding: 0; }
        .header {
            background-color: #1E3A8A;
            color: white;
            padding: 20px;
            font-size: 26px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .header-image {
            height: 60px;
            margin-right: 20px;
        }
        .calendar-container { display: grid; grid-template-columns: repeat(6, 1fr); gap: 5px; padding: 20px; max-width: 1200px; margin: auto; }
        .calendar { background: white; padding: 8px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); text-align: center; transition: transform 0.2s; cursor: pointer; }
        .calendar:hover { transform: scale(1.05); }
        .calendar h3 { background-color: #1E3A8A; color: white; padding: 6px; border-radius: 5px; font-size: 14px; margin: 0; }
        .calendar table { width: 100%; margin-top: 5px; border-collapse: collapse; font-size: 10px; }
        .calendar th, .calendar td { padding: 4px; text-align: center; cursor: pointer; }
        .calendar th { color: #1E3A8A; font-weight: bold; }
        .highlight { background-color: red; color: white; border-radius: 50%; padding: 4px; transition: 0.3s; }
        .highlight:hover { background-color: darkred; }
        .info-container { margin-top: 10px; padding: 10px; background: white; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); text-align: center; max-width: 800px; margin-left: auto; margin-right: auto; }
        .info-container h2 { color: #1E3A8A; text-align: center; }
        .info-container strong { font-weight: bold; }
        .data-table { display: none; } /* Tabela oculta, para edição manual */
    </style>
</head>
<body>
    <div class="header">
        <img src="https://i.imgur.com/bcjzam8.png" alt="Logo TJPA" class="header-image">
        Calendário de Suspensões de Expedientes - 2025
    </div>
    <div class="calendar-container" id="calendarContainer"></div>
    <div class="info-container" id="infoContainer">
        <h2>Informações da Suspensão de Expediente</h2>
        <p id="infoDetails">Clique em um mês para ver as suspensões desse período.</p>
    </div>
    <!-- Tabela para copiar os dados da planilha -->
    <div class="data-table">
        <table border="1">
            <thead>
                <tr>
                    <th>UNIDADE</th>
                    <th>INÍCIO</th>
                    <th>FIM</th>
                    <th>MOTIVO</th>
                    <th>PORTARIA</th>
                    <th>EDIÇÃO DJE</th>
                </tr>
            </thead>
            <tbody id="dataTableBody">
                <!-- Copie os dados da planilha aqui, ex.:
                <tr>
                    <td>Comarca de Santarém</td>
                    <td>20/01/2025</td>
                    <td>20/01/2025</td>
                    <td>Calendário de feriados</td>
                    <td>Portaria N° 5750/2024-GP, DE 6 DE DEZEMBRO DE 2024</td>
                    <td>Lei Federal nº 682/1949</td>
                </tr>
                -->
            </tbody>
        </table>
        <p>Instruções: Copie os dados da aba 'Expediente' da planilha para esta tabela e salve o arquivo.</p>
    </div>
    <script>
        let suspensionsData = {};

        // Função para processar a tabela manual
        function processManualData() {
            const tableBody = document.getElementById('dataTableBody');
            const rows = tableBody.getElementsByTagName('tr');

            suspensionsData = {};

            for (let row of rows) {
                const cells = row.getElementsByTagName('td');
                if (cells.length < 6) continue; // Verifica se a linha tem todos os campos

                const comarca = cells[0].textContent.trim();
                const startDate = cells[1].textContent.trim();
                const endDate = cells[2].textContent.trim();
                const motivo = cells[3].textContent.trim();
                const portaria = cells[4].textContent.trim();
                const fundamento = cells[5].textContent.trim();

                // Extrair dia, mês e ano das datas
                const [startDay, startMonth, startYear] = startDate.split('/').map(Number);
                const [endDay, endMonth, endYear] = endDate.split('/').map(Number);
                const monthName = ["janeiro", "fevereiro", "março", "abril", "maio", "junho", "julho", "agosto", "setembro", "outubro", "novembro", "dezembro"][startMonth - 1];
                console.log(`Mês extraído: ${monthName}, Start: ${startDay}, End: ${endDay}`);

                // Formatar a data para 2025
                const year = 2025;
                const formattedStartDate = `${startDay.toString().padStart(2, '0')}/${startMonth.toString().padStart(2, '0')}/${year}`;
                const formattedEndDate = `${endDay.toString().padStart(2, '0')}/${endMonth.toString().padStart(2, '0')}/${year}`;
                const info = `
                    <strong>${comarca} - ${formattedStartDate} a ${formattedEndDate}</strong><br>
                    Motivo: ${motivo} (TJPA-MEM-2025/XXXX)<br>
                    Portaria ${portaria} - EDIÇÃO DJE nº ${fundamento}
                `;

                if (!suspensionsData[monthName]) {
                    suspensionsData[monthName] = {};
                }

                // Associar a suspensão a todos os dias do intervalo
                for (let day = startDay; day <= endDay; day++) {
                    suspensionsData[monthName][day] = info;
                }
            }

            console.log("Dados mapeados a partir da tabela:", suspensionsData);
            generateCalendar();
        }

        // Função para gerar o calendário
        function generateCalendar() {
            let container = document.getElementById("calendarContainer");
            container.innerHTML = "";
            const months = ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"];
            
            months.forEach((month, index) => {
                let firstDay = new Date(2025, index, 1).getDay();
                let daysInMonth = new Date(2025, index + 1, 0).getDate();
                let calendar = `<div class='calendar' onclick="showSuspensions('${month}')"><h3>${month} 2025</h3><table>`;
                calendar += "<tr><th>D</th><th>S</th><th>T</th><th>Q</th><th>Q</th><th>S</th><th>S</th></tr><tr>";
                for (let i = 0; i < firstDay; i++) calendar += "<td></td>";
                for (let day = 1; day <= daysInMonth; day++) {
                    let highlightClass = (suspensionsData[month] && suspensionsData[month][day]) ? "highlight" : "";
                    calendar += `<td class='${highlightClass}' data-day='${day}'>${day}</td>`;
                    if ((day + firstDay) % 7 === 0) calendar += "</tr><tr>";
                }
                calendar += "</tr></table></div>";
                container.innerHTML += calendar;
            });
        }

        // Função para exibir as suspensões
        function showSuspensions(month) {
            let infoDetails = document.getElementById("infoDetails");
            if (suspensionsData[month]) {
                // Remover repetições usando um Set
                let uniqueInfos = new Set();
                Object.values(suspensionsData[month]).forEach(susp => {
                    uniqueInfos.add(susp);
                });
                infoDetails.innerHTML = Array.from(uniqueInfos).join("<br>") || `Nenhuma suspensão registrada para ${month}.`;
            } else {
                infoDetails.innerHTML = `Nenhuma suspensão registrada para ${month}.`;
            }
        }

        // Processar a tabela manual ao carregar a página
        window.onload = processManualData;
    </script>
</body>
</html>
